<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Event Registration</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <style>
    /* CSS styles unchanged for brevity */
  </style>
</head>
<body>
  <div class="container">
    <!-- Banner and Header content unchanged -->

    <form name="event-registration" method="POST" data-netlify="true" netlify-honeypot="bot-field" enctype="multipart/form-data" class="section">
      <input type="hidden" name="form-name" value="event-registration" />
      <input type="hidden" name="bot-field" />

      <h2>Event Registration Form</h2>
      <!-- Main Participant Fields unchanged -->

      <div id="membersList">
        <h3>Additional Members (Max 15)</h3>
      </div>

      <button type="button" onclick="addMember()">Add Member</button>

      <!-- Bank details and file upload unchanged -->

      <h3>Total Participants: <span id="totalCount">1</span></h3>
      <h3>Total Amount: LKR <span id="totalAmount">0</span></h3>

      <button type="submit">Submit Registration</button>
    </form>

    <script>
      let memberCount = 0;
      const maxMembers = 15;

      function toggleMemberNo(select) {
        const div = document.getElementById('memberNoDiv');
        div.style.display = select.value === "Yes" ? "block" : "none";
      }

      function addMember() {
        if (memberCount >= maxMembers) return alert("Maximum 15 additional members allowed.");

        memberCount++;
        const list = document.getElementById('membersList');
        const div = document.createElement('div');
        div.className = 'member';
        div.id = `member-${memberCount}`;
        div.innerHTML = `
          <button type="button" class="remove-member-btn" onclick="removeMember(${memberCount})">Remove</button>
          <h4>Member ${memberCount}</h4>
          <label>Civil Status:
            <select name="member${memberCount}_civilStatus" required>
              <option>Mr</option>
              <option>Mrs</option>
              <option>Ms</option>
              <option>Miss</option>
              <option>Dr</option>
              <option>Prof</option>
              <option>Rev</option>
            </select>
          </label>
          <label>First Name: <input type="text" name="member${memberCount}_firstName" required /></label>
          <label>Last Name: <input type="text" name="member${memberCount}_lastName" required /></label>
          <label>Designation: <input type="text" name="member${memberCount}_designation" required /></label>
          <label>Contact No: <input type="tel" name="member${memberCount}_contact" required /></label>
          <label>Email: <input type="email" name="member${memberCount}_email" required /></label>
          <label>Ticket Type:
            <select name="member${memberCount}_ticketPrice" required onchange="updateTotal()">
              <option value="18500">IIA Member - LKR 18,500</option>
              <option value="21500">Non-Member - LKR 21,500</option>
            </select>
          </label>
        `;
        list.appendChild(div);
        updateTotal();
      }

      function removeMember(id) {
        const div = document.getElementById(`member-${id}`);
        if (div) div.remove();
        memberCount--;
        updateTotal();
      }

      function updateTotal() {
        let total = 0;
        let count = 1; // main participant
        const mainTicket = document.getElementById("ticketPrice").value;
        if (!isNaN(mainTicket)) total += parseInt(mainTicket);

        for (let i = 1; i <= maxMembers; i++) {
          const select = document.querySelector(`[name=member${i}_ticketPrice]`);
          if (select) {
            count++;
            const val = parseInt(select.value);
            if (!isNaN(val)) total += val;
          }
        }

        document.getElementById("totalCount").textContent = count;
        document.getElementById("totalAmount").textContent = total.toLocaleString();
      }
    </script>

    <form name="event-registration" netlify hidden>
      <input name="civilStatus" />
      <input name="firstName" />
      <input name="lastName" />
      <input name="iiaMember" />
      <input name="memberNo" />
      <input name="companyName" />
      <input name="designation" />
      <input name="email" />
      <input name="contactNo" />
      <input name="ticketPrice" />
      <input name="paymentSlip" type="file" />
      <!-- Dummy fields for max 15 members -->
      <!-- The dummy fields can be expanded manually or generated via backend -->
    </form>
  </div>
</body>
</html>
